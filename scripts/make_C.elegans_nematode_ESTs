#!/usr/local/bin/perl5.6.0
#
# make_C.elegans_nematode_ESTs
#
# dl1
# 

$|=1;

open (SEQUENCES, "/usr/local/pubseq/bin/getzc -sf fasta -f \"id acc des seq\" \'([emblrelease-org:caenorhabditis elegans] \& [emblrelease-div:est])\' |") ;

while (<SEQUENCES>) {
	if (/^AC\s+/ || /^DE\s+/ || /^>/ || /^ID\s+/) {} else {print;}
	if (/^AC\s+(\S+);/) {$acc=$1;}
	if (/^ID\s+(\S+)/) {$id=$1;}
	if (/^DE\s+(.+)/) {$def=$def." ".$1;}
       	if (/^>/) {
	    print ">$acc $id $def\n";
	    $def="";
	    $id="";
	    $acc="";
	} 
}
close SEQUENCES;
