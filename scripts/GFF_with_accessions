#!/usr/local/bin/perl5.6.1 -w
#
# GFF_with_accessions
#
# by Dan Lawson
#
#
# Last updated by: $Author: krb $     
# Last updated on: $Date: 2003-01-14 16:13:41 $      

use strict;                                      
use lib "/wormsrv2/scripts/";                    
use Wormbase;
use Ace;

$|=1;

my $file   = shift;
my $wormdb = "/wormsrv2/autoace";

my $db = Ace->connect(-path=>$wormdb) || do { print "Connection failure: ",Ace->error; die();};

open (GFF, "<$file") || die "Can't open GFF file\n\n";
while (<GFF>) {

  next if (/^\#/);
  
  chomp;

  my @gff = split (/\t/,$_);
  
  my ($gen_can) = $gff[8] =~ /Sequence \"(\S+)\"/; 
  
  my $obj = $db->fetch(Sequence=>$gen_can);
  if (!defined ($obj)) {
    print "Could not fetch sequence '$gen_can'\n";
    next;
  }
  
  my @acc = $obj->DB_info->row();
    
  print "$_ acc=$acc[3] ver=$acc[4]\n";

  $obj->DESTROY();

}
close(GFF);
$db->close;
exit(0);

