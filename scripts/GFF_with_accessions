#!/usr/local/bin/perl

use Ace;

$|=1;

$file   = shift;
$wormdb = "/wormsrv2/autoace";

$db = Ace->connect(-path=>$wormdb) || do { print "Connection failure: ",Ace->error; die();};

open (GFF, "<$file") || die "Can't open GFF file\n\n";
while (<GFF>) {

    next if (/^\#/);
    
    chomp;

    @gff = split (/\t/,$_);
    
    ($gen_can) = $gff[8] =~ /Sequence \"(\S+)\"/; 

    $obj = $db->fetch(Sequence=>$gen_can);
    if (!defined ($obj)) {
        print "Could not fetch sequence '$gen_can'\n";
        next;
    }

    # exceptions WS32
    if ($gen_can eq "ZK1236R") {print "$_ acc=n/a\n"; next;}
    if ($gen_can eq "Y66A7AL") {print "$_ acc=n/a\n"; next;}
    if ($gen_can eq "Y66D12A") {print "$_ acc=n/a\n"; next;}
    if ($gen_can eq "Y66A7AR") {print "$_ acc=n/a\n"; next;}

    @acc = $obj->DB_info->row();
    
    print "$_ acc=$acc[4]\n";

    $obj->DESTROY();

}
close GFF;
exit(0);

